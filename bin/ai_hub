#!/usr/bin/env ruby
# frozen_string_literal: true

KEYS = %w[
    AI_API_GEMINI_URL=
    AI_API_GEMINI_KEY=
    AI_API_DEEPSEEK_URL=
    AI_API_DEEPSEEK_KEY=
  ]

rails_path = ENV['RAILS_ROOT'] || Dir.pwd
config_file_path = File.join(rails_path, '.secrets')
bash_file = if ENV['SHELL'].include?('zsh')
              File.expand_path('~/.zshrc')
            else
              File.expand_path('~/.bashrc')
            end

unless File.exist?(config_file_path)
  File.write(config_file_path, KEYS.join("\n"))

  puts "Please set the environment variables in .secrets file."
  exit 1
else
  file = File.open(config_file_path, "r")
end

File.open(bash_file,'a') do |bash|
  file.readlines.each do |var|
    bash.puts "\nexport #{var}"
  end
  puts "Environment variables were created in the bash file from secrets"
end

file.close